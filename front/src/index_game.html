<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script src="/asset/phaser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
</head>
<body>
    <script type="text/javascript" charset="utf-8">
        var socket = io("http://127.0.0.1:5001");
        socket.on('message', function (message) {
            console.log(message);
        });
    </script>
    <script>
        var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        parent: 'phaser-example',
        dom: {
            createContainer: true
        },
        scene: {
            preload: preload,
            create: create
        }
    };

    var element;

    var game = new Phaser.Game(config);

    function preload ()
    {
        this.load.html('nameform', '/asset/loginform.html');
        this.load.image('pic', '/pic/kosmos.jpg');
    }

    function create ()
    {
        this.add.image(400, 300, 'pic');

        var text = this.add.text(10, 10, 'Игра ваще космос, просто попробуй!', { color: 'white', fontFamily: 'Arial', fontSize: '32px '});

        var element = this.add.dom(400, 600).createFromCache('nameform');

        element.setPerspective(800);

        element.addListener('click');

        element.on('click', function (event) {

            if (event.target.name === 'loginButton')
            {
                var inputWallet = this.getChildByName('wallet_address');

                //  Have they entered anything?
                if (inputWallet.value !== '')
                {
                    //  Turn off the click events
                    this.removeListener('click');

                    //  Tween the login form out
                    this.scene.tweens.add({ targets: element.rotate3d, x: 1, w: 90, duration: 3000, ease: 'Power3' });

                    this.scene.tweens.add({ targets: element, scaleX: 2, scaleY: 2, y: 700, duration: 3000, ease: 'Power3',
                        onComplete: function ()
                        {
                            element.setVisible(false);
                        }
                    });

                    //  Populate the text with whatever they typed in as the username!
                    text.setText('Дарова ' + inputWallet.value + '. Но тут пока ничего нет!');

                    // Send auth info to server
                    // Here should be TON Connect 2.0 code which recieves... something like token I suppose
                    // But since we have no TON Connect yet, send plain wallet. Yay!
                    socket.emit('auth', {wallet: inputWallet.value, token: "YAY!"});
                }
                else
                {
                    //  Flash the prompt
                    this.scene.tweens.add({ targets: text, alpha: 0.1, duration: 200, ease: 'Power3', yoyo: true });
                }
            }

        });
    
        this.tweens.add({
            targets: element,
            y: 300,
            duration: 3000,
            ease: 'Power3'
        });
    }
    </script>

</body>
</html>